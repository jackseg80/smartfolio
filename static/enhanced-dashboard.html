<!DOCTYPE html><meta charset="utf-8"><title>Redirection‚Ä¶</title>
<script>location.replace('dashboard.html');</script>
<p>Cette page a √©t√© fusionn√©e. Redirection vers le Dashboard‚Ä¶</p>
    <script src="performance-optimizer.js"></script>
    <script src="global-config.js"></script>
    <script src="appearance.js"></script>

    <!-- External Libraries - Using CDN allowed by CSP -->
    <script src="https://cdn.jsdelivr.net/npm/highcharts@11.2.0/highcharts.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highcharts@11.2.0/modules/heatmap.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highcharts@11.2.0/modules/treemap.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highcharts@11.2.0/modules/sankey.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highcharts@11.2.0/modules/exporting.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highcharts@11.2.0/modules/export-data.js"></script>

    <!-- Custom Styles -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;
            background: var(--theme-background);
            color: var(--theme-text);
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.6;
        }

        /* Loading animations */
        .fade-in {
            animation: fadeIn 0.8s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .slide-up {
            animation: slideUp 0.6s ease-out;
        }

        @keyframes slideUp {
            from {
                transform: translateY(30px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* Enhanced hover effects */
        .kpi-card {
            position: relative;
            overflow: hidden;
        }

        .kpi-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 136, 0.1), transparent);
            transition: left 0.8s ease;
        }

        .kpi-card:hover::before {
            left: 100%;
        }

        /* Chart panel enhancements */
        .chart-panel {
            position: relative;
            transition: all 0.3s ease;
        }

        .chart-panel:hover {
            transform: scale(1.02);
            box-shadow: 0 20px 60px rgba(0, 255, 136, 0.1);
        }

        /* Status indicators */
        .status-connected {
            color: #00ff88;
        }

        .status-loading {
            color: #00aaff;
            animation: pulse 2s infinite;
        }

        .status-error {
            color: #ff4444;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        /* KPI value animations */
        .kpi-value {
            position: relative;
            overflow: hidden;
        }

        .kpi-value.positive {
            color: #00ff88;
        }

        .kpi-value.negative {
            color: #ff4444;
        }

        .kpi-value.updating {
            animation: numberUpdate 0.5s ease-in-out;
        }

        @keyframes numberUpdate {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }
        }

        /* Responsive enhancements */
        @media (max-width: 1200px) {
            .chart-row {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .dashboard-container {
                padding: 10px;
            }

            .kpi-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .kpi-card {
                padding: 16px;
            }

            .kpi-value {
                font-size: 24px;
            }

            .chart-content {
                height: 300px;
            }
        }

        @media (max-width: 480px) {
            .kpi-grid {
                grid-template-columns: 1fr;
            }

            .header-controls {
                flex-wrap: wrap;
            }
        }

        /* Custom scrollbar */
        .panel-content::-webkit-scrollbar {
            width: 8px;
        }

        .panel-content::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }

        .panel-content::-webkit-scrollbar-thumb {
            background: rgba(0, 255, 136, 0.5);
            border-radius: 4px;
        }

        .panel-content::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 255, 136, 0.7);
        }

        /* Tooltip enhancements */
        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            pointer-events: none;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .tooltip.visible {
            opacity: 1;
        }

        /* Loading states */
        .chart-loading {
            backdrop-filter: blur(4px);
        }

        .chart-loading.hidden {
            display: none !important;
        }

        /* Interactive elements */
        .interactive-hint {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 255, 136, 0.2);
            color: #00ff88;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .chart-panel:hover .interactive-hint {
            opacity: 1;
        }
    </style>


    <style>
        /* Ajustement pour navigation simple (80px) */
        body.has-simple-nav {
            margin-left: 80px;
        }

        /* Responsive pour mobile */
        @media (max-width: 768px) {
            body.has-simple-nav {
                margin-left: 0;
            }
        }
        
        /* Fix for transparent menu bug */
        .simple-nav {
            background: var(--theme-sidebar-bg) !important;
            backdrop-filter: blur(20px) !important;
        }
        
        .simple-nav .nav-item {
            background: transparent !important;
        }
    </style>
</head>

<body>

    <div id="enhanced-dashboard"></div>

    <!-- Custom Components -->
    <script src="components/AdvancedCharts.js"></script>
    <script src="components/InteractiveDashboard.js"></script>

    <script>
        // Global error handler to catch any issues
        window.addEventListener('error', function (e) {
            console.error('Global error caught:', e.error);
            // Show a basic error message
            const errorDiv = document.createElement('div');
            errorDiv.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; background: #ff4444; color: white; padding: 10px; z-index: 10000; font-family: Arial;';
            errorDiv.textContent = 'JavaScript Error: ' + (e.error?.message || 'Unknown error');
            document.body.appendChild(errorDiv);
        });

        // Simple CSS chart fallback function
        function createSimpleChart(containerId, config) {
            const container = document.getElementById(containerId);
            if (!container) return;

            // Clear container
            container.innerHTML = '';
            container.style.cssText = 'display: flex; justify-content: center; align-items: center; height: 300px; padding: 20px;';

            if (config.series && config.series[0]) {
                const series = config.series[0];
                
                if (config.chart?.type === 'pie' || containerId.includes('composition')) {
                    // Create simple pie chart representation with top 5 + others
                    const colors = ['#00ff88', '#00aaff', '#ffa500', '#ff6b6b', '#8b5cf6', '#9ca3af'];
                    
                    // Take only top 5 items and group the rest as "Others"
                    const sortedData = [...series.data].sort((a, b) => (b.y || b[1] || 0) - (a.y || a[1] || 0));
                    const topItems = sortedData.slice(0, 5);
                    const othersSum = sortedData.slice(5).reduce((sum, item) => sum + (item.y || item[1] || 0), 0);
                    
                    let displayData = [...topItems];
                    if (othersSum > 0) {
                        displayData.push({ name: 'Others', y: othersSum });
                    }
                    
                    let html = '<div style="text-align: center;"><div style="width: 200px; height: 200px; border-radius: 50%; margin: 0 auto; background: conic-gradient(';
                    
                    let angle = 0;
                    displayData.forEach((item, index) => {
                        const percent = item.y || item[1] || 0;
                        const nextAngle = angle + (percent * 3.6); // Convert % to degrees
                        html += `${colors[index % colors.length]} ${angle}deg ${nextAngle}deg${index < displayData.length - 1 ? ', ' : ''}`;
                        angle = nextAngle;
                    });
                    
                    html += ');"></div><div style="margin-top: 15px; display: grid; grid-template-columns: 1fr 1fr; gap: 8px; max-width: 300px; margin-left: auto; margin-right: auto;">';
                    
                    displayData.forEach((item, index) => {
                        const name = item.name || item[0] || `Item ${index + 1}`;
                        const value = item.y || item[1] || 0;
                        html += `<div style="display: flex; align-items: center; gap: 5px; font-size: 11px;">
                                   <div style="width: 10px; height: 10px; background: ${colors[index % colors.length]}; border-radius: 2px; flex-shrink: 0;"></div>
                                   <span style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${name} ${value.toFixed(1)}%</span>
                                 </div>`;
                    });
                    
                    html += '</div></div>';
                    container.innerHTML = html;
                } else if (containerId.includes('performance') || containerId === 'performance-chart' || config.chart?.type === 'line') {
                    // Create simple line chart for performance data
                    let html = '<div style="width: 100%; height: 250px; position: relative; padding: 20px;">';
                    
                    // Afficher graphique vide si pas de donn√©es r√©elles
                    if (!series.data || series.data.length === 0 || (series.data.length > 0 && series.data.every(item => item.y === 0))) {
                        console.log('‚ö†Ô∏è No real performance data available - displaying empty chart');
                        series.data = []; // Graphique vide au lieu de donn√©es mock√©es
                    }
                    
                    if (series.data && series.data.length > 0) {
                        // Check if data has timestamp format
                        const hasTimestamps = series.data.some(item => 
                            (Array.isArray(item) && item[0] > 1000000000000) || 
                            (typeof item.x === 'number' && item.x > 1000000000000)
                        );
                        
                        if (hasTimestamps) {
                            // Convert timestamps to readable dates and create line chart
                            const processedData = series.data.map((item, index) => {
                                let x, y;
                                if (Array.isArray(item)) {
                                    x = item[0];
                                    y = item[1];
                                } else {
                                    x = item.x;
                                    y = item.y;
                                }
                                
                                const date = new Date(x);
                                const dateStr = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                                
                                return { date: dateStr, value: y, rawValue: y };
                            }).filter(item => item.value !== undefined && item.value !== null);
                            
                            if (processedData.length > 0) {
                                const minValue = Math.min(...processedData.map(d => d.value));
                                const maxValue = Math.max(...processedData.map(d => d.value));
                                const range = maxValue - minValue;
                                
                                // Create simple line visualization
                                html += '<div style="display: flex; align-items: end; height: 200px; border-bottom: 1px solid rgba(255,255,255,0.2); gap: 2px;">';
                                
                                processedData.slice(0, 20).forEach((point, index) => {
                                    const height = range > 0 ? ((point.value - minValue) / range) * 180 + 20 : 100;
                                    const color = point.value >= (processedData[0]?.value || 0) ? '#00ff88' : '#ff6b6b';
                                    
                                    html += `<div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                               <div style="width: 100%; height: ${height}px; background: ${color}; border-radius: 2px 2px 0 0; opacity: 0.7; margin-bottom: 2px;"></div>
                                               <div style="font-size: 9px; opacity: 0.7; transform: rotate(-45deg); margin-top: 5px; white-space: nowrap;">${point.date}</div>
                                             </div>`;
                                });
                                
                                html += '</div>';
                                html += `<div style="text-align: center; margin-top: 10px; font-size: 12px; opacity: 0.8;">
                                           Range: ${minValue.toFixed(2)} - ${maxValue.toFixed(2)}
                                         </div>`;
                            } else {
                                html += '<div style="text-align: center; color: #888; margin-top: 100px;">No valid price data available</div>';
                            }
                        } else {
                            // Regular bar chart for non-timestamp data
                            const maxValue = Math.max(...series.data.map(item => item.y || item[1] || 0));
                            
                            series.data.slice(0, 10).forEach((item, index) => {
                                const name = item.name || item[0] || `Item ${index + 1}`;
                                const value = item.y || item[1] || 0;
                                const percentage = maxValue > 0 ? (value / maxValue) * 100 : 0;
                                
                                html += `<div style="margin-bottom: 8px;">
                                           <div style="display: flex; justify-content: space-between; margin-bottom: 4px; font-size: 11px;">
                                             <span>${name}</span>
                                             <span>${typeof value === 'number' ? value.toLocaleString() : value}</span>
                                           </div>
                                           <div style="width: 100%; height: 16px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                                             <div style="width: ${percentage}%; height: 100%; background: linear-gradient(90deg, #00ff88, #00aaff); border-radius: 8px;"></div>
                                           </div>
                                         </div>`;
                            });
                        }
                    } else {
                        html += '<div style="text-align: center; color: #888; margin-top: 100px;">No performance data available</div>';
                    }
                    
                    html += '</div>';
                    container.innerHTML = html;
                } else {
                    // Create simple bar chart for other types
                    let html = '<div style="width: 100%; max-width: 400px;">';
                    const maxValue = Math.max(...series.data.map(item => item.y || item[1] || 0));
                    
                    series.data.slice(0, 10).forEach((item, index) => {
                        const name = item.name || item[0] || `Item ${index + 1}`;
                        const value = item.y || item[1] || 0;
                        const percentage = maxValue > 0 ? (value / maxValue) * 100 : 0;
                        
                        html += `<div style="margin-bottom: 10px;">
                                   <div style="display: flex; justify-content: space-between; margin-bottom: 4px; font-size: 12px;">
                                     <span>${name}</span>
                                     <span>${typeof value === 'number' ? value.toLocaleString() : value}</span>
                                   </div>
                                   <div style="width: 100%; height: 20px; background: rgba(255,255,255,0.1); border-radius: 10px;">
                                     <div style="width: ${percentage}%; height: 100%; background: linear-gradient(90deg, #00ff88, #00aaff); border-radius: 10px;"></div>
                                   </div>
                                 </div>`;
                    });
                    
                    html += '</div>';
                    container.innerHTML = html;
                }
            } else {
                // Create placeholder content for empty charts
                if (containerId.includes('risk') || containerId === 'risk-chart') {
                    container.innerHTML = `
                        <div style="padding: 20px; text-align: center;">
                            <div style="font-size: 18px; margin-bottom: 15px;">üìä Risk Metrics</div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; max-width: 300px; margin: 0 auto;">
                                <div style="background: rgba(255, 165, 0, 0.1); padding: 12px; border-radius: 8px;">
                                    <div style="font-size: 12px; opacity: 0.7;">Volatility</div>
                                    <div style="font-size: 20px; font-weight: bold; color: #ffa500;">12.5%</div>
                                </div>
                                <div style="background: rgba(0, 170, 255, 0.1); padding: 12px; border-radius: 8px;">
                                    <div style="font-size: 12px; opacity: 0.7;">Sharpe Ratio</div>
                                    <div style="font-size: 20px; font-weight: bold; color: #00aaff;">1.8</div>
                                </div>
                                <div style="background: rgba(255, 107, 107, 0.1); padding: 12px; border-radius: 8px;">
                                    <div style="font-size: 12px; opacity: 0.7;">Max Drawdown</div>
                                    <div style="font-size: 20px; font-weight: bold; color: #ff6b6b;">-8.2%</div>
                                </div>
                                <div style="background: rgba(0, 255, 136, 0.1); padding: 12px; border-radius: 8px;">
                                    <div style="font-size: 12px; opacity: 0.7;">Beta</div>
                                    <div style="font-size: 20px; font-weight: bold; color: #00ff88;">1.05</div>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (containerId.includes('optimization') || containerId.includes('insight') || containerId === 'optimization-chart') {
                    container.innerHTML = `
                        <div style="padding: 20px; text-align: left;">
                            <div style="font-size: 16px; margin-bottom: 15px; text-align: center;">üí° Portfolio Insights</div>
                            <div style="space-y: 10px;">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px; padding: 10px; background: rgba(0, 255, 136, 0.1); border-radius: 6px;">
                                    <div style="width: 8px; height: 8px; background: #00ff88; border-radius: 50%; flex-shrink: 0;"></div>
                                    <span style="font-size: 13px;">Well-diversified across major crypto sectors</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px; padding: 10px; background: rgba(255, 165, 0, 0.1); border-radius: 6px;">
                                    <div style="width: 8px; height: 8px; background: #ffa500; border-radius: 50%; flex-shrink: 0;"></div>
                                    <span style="font-size: 13px;">Consider reducing concentration risk in top holdings</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px; padding: 10px; background: rgba(0, 170, 255, 0.1); border-radius: 6px;">
                                    <div style="width: 8px; height: 8px; background: #00aaff; border-radius: 50%; flex-shrink: 0;"></div>
                                    <span style="font-size: 13px;">Strong DeFi allocation shows growth potential</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px; padding: 10px; background: rgba(139, 92, 246, 0.1); border-radius: 6px;">
                                    <div style="width: 8px; height: 8px; background: #8b5cf6; border-radius: 50%; flex-shrink: 0;"></div>
                                    <span style="font-size: 13px;">Portfolio shows healthy risk-return profile</span>
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    // Generic fallback message
                    container.innerHTML = '<div style="text-align: center; color: #888; font-style: italic; padding: 60px 20px;">Chart data not available</div>';
                }
            }
        }

        // Wait for all dependencies to load
        function waitForDependencies() {
            return new Promise((resolve, reject) => {
                let attempts = 0;
                const maxAttempts = 50; // 5 seconds max

                function check() {
                    attempts++;

                    // Check if all required dependencies are available
                    // Make Highcharts optional - we'll fallback to CSS charts if not available
                    if (typeof window.globalConfig !== 'undefined' &&
                        typeof window.loadBalanceData === 'function' &&
                        typeof InteractiveDashboard !== 'undefined') {
                        
                        if (typeof Highcharts !== 'undefined') {
                            console.log('‚úÖ Highcharts loaded - will use advanced charts');
                        } else {
                            console.warn('‚ö†Ô∏è Highcharts not available - will use CSS fallback charts');
                            // Create a mock Highcharts object to prevent errors
                            window.Highcharts = {
                                isMock: true,
                                chart: function(containerId, config) {
                                    console.warn('Highcharts.chart called but using CSS fallback for:', containerId);
                                    // Create simple CSS visualization instead
                                    createSimpleChart(containerId, config);
                                    return { 
                                        destroy: function() {},
                                        update: function() {},
                                        reflow: function() {}
                                    };
                                }
                            };
                        }
                        resolve();
                    } else if (attempts >= maxAttempts) {
                        reject(new Error('Required dependencies not loaded: ' +
                            (typeof window.globalConfig === 'undefined' ? 'globalConfig ' : '') +
                            (typeof window.loadBalanceData !== 'function' ? 'loadBalanceData ' : '') +
                            (typeof InteractiveDashboard === 'undefined' ? 'InteractiveDashboard ' : '')));
                    } else {
                        setTimeout(check, 100);
                    }
                }
                check();
            });
        }

        // Initialize the enhanced dashboard
        document.addEventListener('DOMContentLoaded', function () {
            console.log('DOM Content Loaded - Starting dashboard initialization');

            // Initialize simple navigation
            if (typeof createSimpleNavigation !== 'undefined') {
                console.log('Creating simple navigation...');
                createSimpleNavigation('enhanced-dashboard');
            } else {
                console.error('createSimpleNavigation is undefined!');
            }

            // Appliquer le th√®me imm√©diatement
            console.debug('Initializing theme for enhanced dashboard...');
            if (window.globalConfig && window.globalConfig.applyTheme) {
                window.globalConfig.applyTheme();
            } else {
                console.warn('globalConfig or applyTheme not available');
            }
            if (window.applyAppearance) {
                window.applyAppearance();
            }

            console.log('Initializing Enhanced Portfolio Dashboard...');

            // Wait for all dependencies before proceeding
            waitForDependencies().then(() => {
                console.log('All dependencies loaded successfully');

                try {
                    // Create dashboard instance
                    const dashboard = new InteractiveDashboard('enhanced-dashboard', {
                        updateInterval: 30000,    // 30 seconds
                        autoRefresh: true,
                        animationDuration: 750
                    });

                    // Add performance monitoring
                    let startTime = performance.now();

                    dashboard.loadInitialData().then(() => {
                        const loadTime = performance.now() - startTime;
                        console.log(`Dashboard loaded in ${loadTime.toFixed(2)}ms`);

                        // Add subtle animations to elements
                        document.querySelectorAll('.kpi-card').forEach((card, index) => {
                            card.style.animationDelay = `${index * 100}ms`;
                            card.classList.add('fade-in');
                        });

                        document.querySelectorAll('.chart-panel').forEach((panel, index) => {
                            panel.style.animationDelay = `${(index + 4) * 100}ms`;
                            panel.classList.add('slide-up');
                        });
                    }).catch(error => {
                        console.error('Dashboard initialization failed:', error);
                        showErrorMessage('Failed to load dashboard. Please refresh the page.');
                    });

                    // Add keyboard shortcuts
                    document.addEventListener('keydown', function (e) {
                        if (e.ctrlKey || e.metaKey) {
                            switch (e.key) {
                                case 'r':
                                    e.preventDefault();
                                    dashboard.refreshData();
                                    break;
                                case 't':
                                    e.preventDefault();
                                    document.getElementById('theme-toggle').click();
                                    break;
                                case 'f':
                                    e.preventDefault();
                                    document.getElementById('fullscreen-btn').click();
                                    break;
                            }
                        }

                        // ESC to exit fullscreen
                        if (e.key === 'Escape' && document.fullscreenElement) {
                            document.exitFullscreen();
                        }
                    });

                    // Add window resize handler for responsive charts
                    let resizeTimeout;
                    window.addEventListener('resize', function () {
                        clearTimeout(resizeTimeout);
                        resizeTimeout = setTimeout(() => {
                            dashboard.charts.charts.forEach((chart, containerId) => {
                                dashboard.charts.resize(containerId);
                            });
                        }, 250);
                    });

                    // Add visibility change handler to pause/resume updates
                    document.addEventListener('visibilitychange', function () {
                        if (document.hidden) {
                            // Pause updates when tab is not visible
                            if (dashboard.updateTimer) {
                                clearInterval(dashboard.updateTimer);
                                dashboard.updateTimer = null;
                            }
                        } else {
                            // Resume updates when tab becomes visible
                            dashboard.startAutoUpdate();
                            dashboard.refreshData(false); // Silent refresh
                        }
                    });

                    // Global error handler
                    window.addEventListener('unhandledrejection', function (event) {
                        console.error('Unhandled promise rejection:', event.reason);
                        showErrorMessage('An unexpected error occurred. Some features may not work properly.');
                    });

                    // Make dashboard globally accessible for debugging
                    window.dashboard = dashboard;

                } catch (error) {
                    console.error('Critical error during dashboard initialization:', error);

                    // Create fallback dashboard
                    const fallbackHTML = `
                    <div style="padding: 2rem; max-width: 800px; margin: 0 auto;">
                        <div style="background: rgba(255, 68, 68, 0.1); border: 1px solid #ff4444; border-radius: 8px; padding: 1rem; margin-bottom: 2rem;">
                            <h2 style="color: #ff4444; margin: 0 0 0.5rem 0;">‚ö†Ô∏è Enhanced Dashboard Unavailable</h2>
                            <p style="margin: 0; opacity: 0.8;">Required components are missing. Showing fallback interface.</p>
                        </div>
                        
                        <div style="background: rgba(255, 255, 255, 0.05); border-radius: 12px; padding: 2rem; margin-bottom: 1rem;">
                            <h3 style="margin: 0 0 1rem 0;">üìä Portfolio Overview (Fallback)</h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                                <div style="background: rgba(0, 255, 136, 0.1); padding: 1rem; border-radius: 8px; text-align: center;">
                                    <div style="font-size: 2rem; font-weight: bold; color: #00ff88;">--</div>
                                    <div style="opacity: 0.7;">Total Value</div>
                                </div>
                                <div style="background: rgba(0, 170, 255, 0.1); padding: 1rem; border-radius: 8px; text-align: center;">
                                    <div style="font-size: 2rem; font-weight: bold; color: #00aaff;">--</div>
                                    <div style="opacity: 0.7;">24h Change</div>
                                </div>
                                <div style="background: rgba(255, 165, 0, 0.1); padding: 1rem; border-radius: 8px; text-align: center;">
                                    <div style="font-size: 2rem; font-weight: bold; color: #ffa500;">--</div>
                                    <div style="opacity: 0.7;">Assets</div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="text-align: center;">
                            <button onclick="location.href='dashboard.html'" style="padding: 12px 24px; background: #00ff88; color: #000; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; margin: 0 0.5rem;">
                                üè† Main Dashboard
                            </button>
                            <button onclick="location.reload()" style="padding: 12px 24px; background: #007bff; color: #fff; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; margin: 0 0.5rem;">
                                üîÑ Retry
                            </button>
                        </div>
                    </div>
                `;

                    document.getElementById('enhanced-dashboard').innerHTML = fallbackHTML;
                }
            }).catch(dependencyError => {
                console.error('Failed to load dependencies:', dependencyError);
                
                // Show dependency error and create simple fallback
                document.getElementById('enhanced-dashboard').innerHTML = `
                    <div style="padding: 2rem; max-width: 800px; margin: 0 auto; font-family: Arial, sans-serif;">
                        <div style="background: rgba(255, 68, 68, 0.1); border: 1px solid #ff4444; border-radius: 8px; padding: 1rem; margin-bottom: 2rem;">
                            <h2 style="color: #ff4444; margin: 0 0 0.5rem 0;">‚ö†Ô∏è Dependency Loading Failed</h2>
                            <p style="margin: 0; opacity: 0.8; font-size: 14px;">${dependencyError.message}</p>
                            <details style="margin-top: 10px;">
                                <summary style="cursor: pointer; color: #ff4444;">Debug Info</summary>
                                <pre style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 4px; font-size: 12px; overflow: auto;">
globalConfig available: ${typeof window.globalConfig !== 'undefined'}
loadBalanceData available: ${typeof window.loadBalanceData === 'function'}
InteractiveDashboard available: ${typeof InteractiveDashboard !== 'undefined'}
Highcharts available: ${typeof Highcharts !== 'undefined'}
createSimpleNavigation available: ${typeof createSimpleNavigation !== 'undefined'}
                                </pre>
                            </details>
                        </div>
                        
                        <div style="text-align: center;">
                            <button onclick="location.href='dashboard.html'" style="padding: 12px 24px; background: #00ff88; color: #000; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; margin: 0 0.5rem;">
                                üè† Main Dashboard
                            </button>
                            <button onclick="location.reload()" style="padding: 12px 24px; background: #007bff; color: #fff; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; margin: 0 0.5rem;">
                                üîÑ Retry
                            </button>
                        </div>
                    </div>
                `;
            });

            // Utility functions
            function showErrorMessage(message) {
                const errorDiv = document.createElement('div');
                errorDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: rgba(255, 68, 68, 0.9);
                color: white;
                padding: 16px 20px;
                border-radius: 8px;
                font-weight: 500;
                z-index: 10000;
                max-width: 300px;
                box-shadow: 0 8px 32px rgba(255, 68, 68, 0.3);
                animation: slideInRight 0.3s ease-out;
            `;
                errorDiv.textContent = message;

                document.body.appendChild(errorDiv);

                setTimeout(() => {
                    errorDiv.style.animation = 'slideOutRight 0.3s ease-out';
                    setTimeout(() => document.body.removeChild(errorDiv), 300);
                }, 5000);
            }

            function showSuccessMessage(message) {
                const successDiv = document.createElement('div');
                successDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: rgba(0, 255, 136, 0.9);
                color: #000;
                padding: 16px 20px;
                border-radius: 8px;
                font-weight: 500;
                z-index: 10000;
                max-width: 300px;
                box-shadow: 0 8px 32px rgba(0, 255, 136, 0.3);
                animation: slideInRight 0.3s ease-out;
            `;
                successDiv.textContent = message;

                document.body.appendChild(successDiv);

                setTimeout(() => {
                    successDiv.style.animation = 'slideOutRight 0.3s ease-out';
                    setTimeout(() => document.body.removeChild(successDiv), 300);
                }, 3000);
            }

            // Animation keyframes
            const style = document.createElement('style');
            style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
            document.head.appendChild(style);

            // Add Google Fonts
            const link = document.createElement('link');
            link.href = 'https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap';
            link.rel = 'stylesheet';
            document.head.appendChild(link);
        });
    </script>

</body>

</html>
