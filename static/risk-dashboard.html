<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Risk Dashboard - SmartFolio</title>

  <!-- Th√®me/compat identiques √† ta page actuelle -->
  <link rel="stylesheet" href="css/tokens.css">
    <link rel="stylesheet" href="shared-theme.css">
  <link rel="stylesheet" href="theme-compat.css">

  <!-- Scripts partag√©s existants -->
  <script src="debug-logger.js"></script>
    <script src="components/toast.js" type="module"></script>
  <script src="global-config.js"></script>
  <script type="module" src="network-state-manager.js"></script> <!-- Network resilience layer -->
  <script src="appearance.js"></script> <!-- Critical: must load before first paint to avoid theme flash -->
  <script src="lazy-loader.js"></script>

  <!-- Core modules ESM -->
  <script type="module" src="core/risk-dashboard-store.js"></script>
  <script type="module" src="core/risk-data-orchestrator.js"></script>  <!-- ‚úÖ SSOT hydration -->
  <script type="module" src="core/fetcher.js"></script>

  <!-- CCS modules ESM (kept for risk score calculations) -->
  <script type="module" src="modules/signals-engine.js"></script>
  <script type="module" src="modules/cycle-navigator.js"></script>
  <script type="module" src="modules/onchain-indicators.js"></script>
  <script type="module" src="modules/market-regimes.js"></script>

  <!-- Unified asset groups system -->
  <script type="module" src="shared-asset-groups.js"></script>

  <!-- Chart.js will be lazy-loaded when needed -->

  <!-- Risk Dashboard CSS -->
  <link rel="stylesheet" href="css/risk-dashboard.css">

  <!-- Navigation unifi√©e (conditionnelle) -->
  <script type="module">
    if (new URLSearchParams(window.location.search).get('nav') !== 'off') {
      import('./components/nav.js');
    }
  </script>
  <script type="module" src="components/tooltips.js"></script>

  <!-- Risk Dashboard Orchestrator -->
  <script type="module" src="modules/risk-dashboard-main.js"></script>
</head>

<body>
  <div id="backend-fallback-banner" class="hidden">
    ‚ö† Backend indisponible ‚Äî mode prudent (cap r√©duit).
  </div>

  <div class="wrap">
    <!-- Compact Header Controls -->
    <div class="page-header">
      <div class="page-title">
        <h1>Risk Dashboard</h1>
      </div>
      <div class="header-controls">
        <div class="timestamp" id="last-update">Loading...</div>
        <button class="icon-btn" id="refresh-btn" title="Refresh data" aria-label="Refresh data">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M13.65 2.35C12.2 0.9 10.21 0 8 0 3.58 0 0.01 3.58 0.01 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L9 7h7V0l-2.35 2.35z" fill="currentColor"/>
          </svg>
        </button>
        <div class="dropdown">
          <button class="icon-btn" id="options-menu-btn" title="Options" aria-label="More options" aria-haspopup="true" aria-expanded="false">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="8" cy="3" r="1.5" fill="currentColor"/>
              <circle cx="8" cy="8" r="1.5" fill="currentColor"/>
              <circle cx="8" cy="13" r="1.5" fill="currentColor"/>
            </svg>
          </button>
          <div class="dropdown-menu" id="options-menu">
            <button class="dropdown-item" id="force-refresh-btn" title="Clear cache and recalculate all scores">
              <span class="item-icon">üßπ</span>
              <span class="item-text">Force Refresh</span>
            </button>
            <button class="dropdown-item" id="force-cycle-refresh-btn" title="Clear cycle cache and reload cycles only">
              <span class="item-icon">üîÑ</span>
              <span class="item-text">Refresh Cycles</span>
            </button>
            <div class="dropdown-divider"></div>
            <button class="dropdown-item" id="test-endpoint-btn" title="Test API connection (dev only)">
              <span class="item-icon">üß™</span>
              <span class="item-text">Test API</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Layout Simple: Main Content uniquement (sidebar remplac√©e par Web Component flyout-panel) -->
    <div class="dashboard-layout">
      <!-- Main Content avec Onglets -->
      <div class="main-content">
        <!-- Tabs -->
        <div class="tabs" role="tablist">
          <button class="tab-button active" data-tab="risk" role="tab" aria-selected="true" aria-controls="risk-tab">Risk Overview</button>
          <button class="tab-button" data-tab="cycles" role="tab" aria-selected="false" aria-controls="cycles-tab">Market Cycles</button>
          <button class="tab-button" data-tab="advanced" role="tab" aria-selected="false" aria-controls="advanced-tab">Advanced Risk</button>
        </div>

        <!-- Quick Links to Other Pages -->
        <div class="quick-links" style="display: flex; gap: 12px; margin-bottom: 16px; flex-wrap: wrap;">
          <a href="rebalance.html" class="quick-link-btn" style="display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; background: var(--theme-surface-elevated); border: 1px solid var(--theme-border); border-radius: var(--radius-md); color: var(--theme-text); text-decoration: none; font-size: 14px; transition: all 0.2s;">
            <span>üéØ</span> Strategic Targets
          </a>
          <a href="monitoring.html" class="quick-link-btn" style="display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; background: var(--theme-surface-elevated); border: 1px solid var(--theme-border); border-radius: var(--radius-md); color: var(--theme-text); text-decoration: none; font-size: 14px; transition: all 0.2s;">
            <span>üö®</span> Alerts History
          </a>
        </div>

        <div class="tab-content">
          <!-- Risk Overview Tab -->
          <div class="tab-pane active" id="risk-tab" role="tabpanel" aria-labelledby="risk-overview">
            <div id="risk-overview-badge-container" class="badge-container"></div>

            <!-- Persistent Controls (do not get replaced by dynamic render) -->
            <div id="risk-dashboard-content">
              <div class="loading">Loading risk metrics...</div>
            </div>
          </div>

          <!-- Market Cycles Tab -->
          <div class="tab-pane" id="cycles-tab" role="tabpanel" aria-labelledby="cycles">
            <div id="cycles-badge-container" class="badge-container"></div>
            <div id="cycles-content">
              <div class="loading">Loading cycle analysis...</div>
            </div>
          </div>

          <!-- Advanced Risk Tab (Phase 3A) -->
          <div class="tab-pane" id="advanced-tab" role="tabpanel" aria-labelledby="advanced">
            <div id="advanced-badge-container" class="badge-container"></div>
            <div id="advanced-risk-content">
              <div class="loading">Loading advanced risk analysis...</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tooltip partag√© -->
  <div id="tooltip" class="tooltip" aria-hidden="true" role="tooltip">
    <div class="tip-title"></div>
    <div class="tip-body"></div>
  </div>

  <script type="module" src="modules/risk-dashboard-main-controller.js"></script>

  <!-- Phase 3A: Advanced Risk Analysis -->
  <script type="module">
    import { store } from './core/risk-dashboard-store.js';

    // ====== Phase 3A: Advanced Risk Analysis ======

    async function loadAdvancedRiskComponents() {
      try {
        // Check if advanced panel already exists
        if (document.querySelector('.advanced-risk-panel')) {
          console.debug('Advanced Risk Components already loaded');
          return; // Already loaded
        }

        // Add advanced sections to the Advanced Risk tab
        const advancedContent = document.getElementById('advanced-risk-content');

        // Clear the loading message
        advancedContent.innerHTML = '';

        // Create Advanced Risk Analysis Panel
        const advancedPanel = document.createElement('div');
        advancedPanel.className = 'advanced-section advanced-risk-panel';
        advancedPanel.innerHTML = `
            <div class="risk-grid two-col-advanced">
              <div class="left-stack">
                <!-- Group Risk Index (GRI) -->
                <div class="risk-card">
                  <h4>Group Risk Index (GRI)</h4>
                  <div id="gri-analysis-content">
                    <div class="loading">Loading GRI analysis...</div>
                  </div>
                </div>
                <!-- Monte Carlo -->
                <div class="risk-card">
                  <h4>Monte Carlo Simulation</h4>
                  <div id="monte-carlo-content">
                    <div class="loading">Loading simulations...</div>
                  </div>
                </div>
                <!-- Risk Attribution -->
                <div class="risk-card">
                  <h4>Risk Attribution</h4>
                  <div id="risk-attribution-content">
                    <div class="loading">Loading attribution analysis...</div>
                  </div>
                </div>
              </div>
              <div class="right-stack">
                <!-- Stress Testing (free height on the right) -->
                <div class="risk-card">
                  <h4>Stress Testing</h4>
                  <div id="stress-test-content">
                    <div class="loading">Loading stress tests...</div>
                  </div>
                </div>
              </div>
            </div>
          `;

        advancedContent.appendChild(advancedPanel);

        // Load actual Phase 3A data
        await loadPhase3AData();

      } catch (error) {
        console.error('Error loading advanced risk components:', error);
        window.showToast?.('Failed to load advanced risk analysis', 'error');
      }
    }

    async function loadPhase3AData() {
      try {
        // Get Phase 3A status using globalConfig.apiRequest
        const statusData = await window.globalConfig.apiRequest('/api/phase3/status');

        if (statusData.phase_3a_advanced_risk?.status === 'active') {
          // Load GRI analysis
          await loadGRIAnalysis();
          // Load stress testing scenarios
          await loadStressTestScenarios();
          // Load Monte Carlo results
          await loadMonteCarloResults();
          // Load Risk Attribution
          await loadRiskAttribution();
        } else {
          document.getElementById('gri-analysis-content').innerHTML =
            '<div class="warning">Advanced Risk Engine not available</div>';
        }
      } catch (error) {
        console.error('Error loading Phase 3A data:', error);
      }
    }

    // Debug metadata banner function
    function showDebugMetadataBanner(meta) {
      let banner = document.getElementById('debug-metadata-banner');
      if (!banner) {
        banner = document.createElement('div');
        banner.id = 'debug-metadata-banner';
        banner.style.cssText = `
          position: fixed; top: 0; left: 0; right: 0; z-index: 9999;
          background: color-mix(in oklab, var(--info) 90%, transparent);
          border-bottom: 1px solid var(--info);
          color: var(--theme-text); padding: 0.5rem 1rem; font-size: 0.8rem;
          display: flex; justify-content: space-between; align-items: center;
        `;
        document.body.appendChild(banner);
      }

      banner.innerHTML = `
        <div>
          üè∑Ô∏è <strong>Debug Metadata:</strong>
          User: <code>${meta.user_id}</code> |
          Source: <code>${meta.source_id}</code> |
          Taxonomy: <code>${meta.taxonomy_version}:${meta.taxonomy_hash}</code> |
          Generated: <code>${new Date(meta.generated_at).toLocaleTimeString()}</code>
          ${meta.correlation_id ? `| ID: <code>${meta.correlation_id}</code>` : ''}
        </div>
        <button onclick="this.parentElement.style.display='none'" style="background:none;border:none;color:var(--theme-text);cursor:pointer;font-size:1.2rem;">√ó</button>
      `;
    }

    async function loadGRIAnalysis() {
      try {
        // Get data from API risk dashboard for GRI analysis using globalConfig.apiRequest
        const minUsd = window.globalConfig.get('min_usd_threshold') || 1.0;
        const priceDays = 365;
        const corrDays = 90;

        const data = await window.globalConfig.apiRequest('/api/risk/dashboard', {
          params: {
            price_history_days: priceDays,
            lookback_days: corrDays,
            min_usd: minUsd,
            risk_version: 'v2_active',
            use_dual_window: true
          }
        });

        if (!data.success) {
          throw new Error(data.message || 'API request failed');
        }

        // Display debug metadata banner if debug mode is enabled
        if (localStorage.getItem('debug_metadata') === 'true' && data.meta) {
          showDebugMetadataBanner(data.meta);
        }

        const metrics = data.risk_metrics;
        const exposureByGroup = metrics.exposure_by_group || {};
        const gri = metrics.group_risk_index || 0;

        // Convert exposure to display format
        const topGroups = Object.entries(exposureByGroup)
          .sort(([, a], [, b]) => b - a)
          .map(([name, weight]) => ({
            name,
            weight: Math.round(weight * 100),
            weight_raw: weight
          }));

        // Color coding for GRI score
        const griColor = gri < 3 ? 'var(--success)' : gri < 6 ? 'var(--warning)' : 'var(--danger)';
        const griLevel = gri < 3 ? 'LOW' : gri < 6 ? 'MEDIUM' : 'HIGH';

        // Group risk levels - Calculated by backend V2 engine (services/risk_scoring.py)
        const GROUP_RISK_LEVELS = {
          'Stablecoins': 5, 'BTC': 2, 'ETH': 3, 'L2/Scaling': 5,
          'DeFi': 5, 'AI/Data': 5, 'SOL': 6, 'L1/L0 majors': 6,
          'Gaming/NFT': 6, 'Others': 7, 'Memecoins': 9
        };

        console.debug('üìä GRI groups from API:', Object.keys(exposureByGroup));

        document.getElementById('gri-analysis-content').innerHTML = `
            <div class="gri-overview">
              <div class="var-method">
                <span class="method-label hinted" data-key="gri_index">
                  Group Risk Index (GRI)
                </span>
                <span class="var-value" style="color: ${griColor}">${gri.toFixed(1)}/10</span>
              </div>
              <div class="var-method">
                <span class="method-label hinted" data-key="gri_level">
                  Risk Level
                </span>
                <span class="var-value">${griLevel}</span>
              </div>
              <div class="var-method">
                <span class="method-label hinted" data-key="groups_count">
                  Groups Count
                </span>
                <span class="var-value">${Object.keys(exposureByGroup).length}</span>
              </div>
            </div>
            <div class="gri-groups">
              <h5 class="hinted" data-key="gri_groups_header">
                Exposition & Risque par Groupe
              </h5>
              ${topGroups.map(group => {
                const riskLevel = GROUP_RISK_LEVELS[group.name] || 5;
                const riskColor = riskLevel < 3 ? '#9ece6a' :
                                  riskLevel < 6 ? '#e0af68' :
                                  riskLevel < 8 ? '#ff9e64' :
                                  '#f7768e';

                if (!(group.name in GROUP_RISK_LEVELS)) {
                  console.warn('‚ö†Ô∏è Group name not in risk levels:', group.name, '(using fallback 5/10)');
                }

                return `
                  <div class="var-method hinted" data-key="group:${group.name}" data-risk-level="${riskLevel}" style="position: relative; padding: 0.75rem 0.75rem 0.75rem 0.75rem; background: var(--theme-bg); border-radius: 6px; margin-bottom: 0.5rem; overflow: hidden;">
                    <div style="position: absolute; top: 0; left: 0; height: 100%; width: ${group.weight}%; background: ${riskColor}; opacity: 0.15; border-radius: 6px; transition: width 0.3s ease;"></div>
                    <div style="position: relative; display: flex; justify-content: space-between; align-items: center; gap: 1rem;">
                      <span class="method-label" style="font-weight: 500;">${group.name}</span>
                      <span class="var-value" style="font-weight: 600;">${group.weight}%</span>
                    </div>
                    <span style="position: absolute; right: 0.5rem; top: 50%; transform: translateY(-50%); font-size: 0.7rem; padding: 2px 6px; background: ${riskColor}; color: white; border-radius: 3px; font-weight: 700; box-shadow: 0 1px 3px rgba(0,0,0,0.3);">
                      ${riskLevel}/10
                    </span>
                  </div>
                `;
              }).join('')}
            </div>
            <div class="gri-interpretation">
              <div class="metric-interpretation hinted" data-key="gri_interpretation">
                ${gri < 3 ? '‚úÖ Portfolio faible risque' :
            gri < 6 ? '‚ö†Ô∏è Portfolio risque mod√©r√©' :
              'üö® Portfolio haut risque - Consid√©rer diversifier'}
              </div>
            </div>
          `;

        // Call decorateRiskTooltips to initialize all tooltips
        setTimeout(() => {
          window.decorateRiskTooltips?.();
        }, 100);

      } catch (error) {
        console.error('Error loading GRI Analysis:', error);
        document.getElementById('gri-analysis-content').innerHTML =
          '<div class="error">Failed to load GRI analysis from API</div>';
      }
    }

    async function loadStressTestScenarios() {
      try {
        const scenarios = [
          {
            id: "crisis_2008",
            name: "üìâ Crise Financi√®re 2008",
            description: "R√©plique la chute des march√©s de septembre-novembre 2008",
            impact: { min: -45, max: -60 },
            probability: 0.02,
            duration: "6-12 mois",
            context: "Effondrement Lehman Brothers, crise des subprimes"
          },
          {
            id: "covid_2020",
            name: "ü¶† Crash COVID-19 Mars 2020",
            description: "Chute brutale li√©e √† la pand√©mie mondiale",
            impact: { min: -35, max: -50 },
            probability: 0.05,
            duration: "2-6 mois",
            context: "Confinements mondiaux, arr√™t √©conomique brutal"
          },
          {
            id: "china_ban",
            name: "üá®üá≥ Interdiction Crypto Chine",
            description: "Bannissement complet des cryptos par autorit√©s chinoises",
            impact: { min: -25, max: -40 },
            probability: 0.10,
            duration: "3-9 mois",
            context: "Fermeture exchanges, interdiction mining"
          },
          {
            id: "tether_collapse",
            name: "üí∞ Effondrement Tether",
            description: "Perte de confiance totale dans USDT",
            impact: { min: -30, max: -55 },
            probability: 0.08,
            duration: "1-4 mois",
            context: "D√©couverte de sous-collat√©ralisation massive"
          },
          {
            id: "fed_emergency",
            name: "üè¶ Hausse Taux Fed d'Urgence",
            description: "Remont√©e brutale des taux pour lutter contre l'inflation",
            impact: { min: -20, max: -35 },
            probability: 0.15,
            duration: "6-18 mois",
            context: "Taux directeur √† 8-10%, fuite des capitaux risqu√©s"
          },
          {
            id: "exchange_hack",
            name: "üîì Hack Exchange Majeur",
            description: "Piratage d'un exchange de premier plan (Binance/Coinbase)",
            impact: { min: -15, max: -30 },
            probability: 0.20,
            duration: "1-3 mois",
            context: "Vol de plusieurs milliards, panique g√©n√©rale"
          }
        ];

        const scenariosHtml = scenarios.map(scenario => `
            <div class="scenario-card" onclick="window.showScenarioDetails('${scenario.id}')">
              <div class="scenario-header">
                <h5>${scenario.name}</h5>
                <span class="scenario-probability">${(scenario.probability * 100).toFixed(0)}% / 10 ans</span>
              </div>
              <div class="scenario-impact">
                Impact: ${scenario.impact.min}% √† ${scenario.impact.max}%
              </div>
              <div class="scenario-duration">
                Dur√©e: ${scenario.duration}
              </div>
              <div class="scenario-context">
                ${scenario.context}
              </div>
            </div>
          `).join('');

        document.getElementById('stress-test-content').innerHTML = `
            <div class="stress-scenarios">
              <div class="scenarios-header">
                <p class="scenarios-description">
                  Sc√©narios historiques et hypoth√©tiques pour √©valuer la r√©silience du portefeuille
                </p>
              </div>
              ${scenariosHtml}
              <div class="scenarios-footer">
                <button class="btn-secondary" onclick="window.runAllStressTests()">
                  üß™ Lancer tous les tests
                </button>
                <button class="btn-secondary" onclick="window.createCustomScenario()">
                  ‚öôÔ∏è Sc√©nario personnalis√©
                </button>
              </div>
            </div>
          `;

        window.stressScenarios = scenarios;

      } catch (error) {
        console.error('Error loading stress test scenarios:', error);
        document.getElementById('stress-test-content').innerHTML =
          '<div class="error">Erreur de chargement des sc√©narios de stress</div>';
      }
    }

    // Interaction functions for stress scenarios
    window.showScenarioDetails = function (scenarioId) {
      const scenario = window.stressScenarios?.find(s => s.id === scenarioId);
      if (!scenario) return;

      alert(`${scenario.name}\n\n${scenario.description}\n\nImpact estim√©: ${scenario.impact.min}% √† ${scenario.impact.max}%\nProbabilit√© sur 10 ans: ${(scenario.probability * 100).toFixed(1)}%\nDur√©e typique: ${scenario.duration}`);
    };

    window.runAllStressTests = async function () {
      window.showToast?.('Lancement des tests de stress en cours...', 'info');
      setTimeout(() => {
        window.showToast?.('Tests de stress termin√©s. R√©sultats mis √† jour.', 'success');
      }, 2000);
    };

    window.createCustomScenario = function () {
      window.showToast?.('Fonctionnalit√© de sc√©narios personnalis√©s √† venir', 'info');
    };

    async function loadMonteCarloResults() {
      document.getElementById('monte-carlo-content').innerHTML = `
          <p style="font-size: 0.85rem; color: var(--theme-text-muted); margin-bottom: 1rem; font-style: italic;">
            Simulation de 10 000 sc√©narios al√©atoires bas√©e sur la distribution historique de rendements.
            Fournit une √©valuation probabiliste du risque extr√™me.
          </p>
          <div class="monte-carlo-summary">
            <div class="sim-stat hinted" data-key="mc_simulations">
              <span class="stat-label">Simulations</span>
              <span class="stat-value">10,000</span>
            </div>
            <div class="sim-stat hinted" data-key="mc_worst_case">
              <span class="stat-label">Pire sc√©nario</span>
              <span class="stat-value text-danger">-68.5%</span>
            </div>
            <div class="sim-stat hinted" data-key="mc_loss_prob">
              <span class="stat-label">Probabilit√© perte >20%</span>
              <span class="stat-value">12.3%</span>
            </div>
          </div>
        `;

      setTimeout(() => {
        window.decorateRiskTooltips?.();
      }, 100);
    }

    async function loadRiskAttribution() {
      const el = document.getElementById('risk-attribution-content');
      if (!el) return;
      try {
        const minUsd = window.globalConfig.get('min_usd_threshold') || 1.0;
        const priceDays = 365;
        const corrDays = 90;

        const data = await window.globalConfig.apiRequest('/api/risk/dashboard', {
          params: {
            price_history_days: priceDays,
            lookback_days: corrDays,
            min_usd: minUsd,
            risk_version: 'v2_active',
            use_dual_window: true
          }
        });
        if (!data.success) {
          throw new Error(data.message || 'API request failed');
        }

        const riskMetrics = data.risk_metrics;
        const correlationMetrics = data.correlation_metrics || {};

        el.innerHTML = `
            <p style="font-size: 0.85rem; color: var(--theme-text-muted); margin-bottom: 1rem; font-style: italic;">
              Analyse de la structure du risque et de la diversification du portefeuille.
            </p>
            <div class="var-methods">
              <div class="sim-stat hinted" data-key="diversification_ratio" data-value="${correlationMetrics.diversification_ratio || 0}" style="justify-content:space-between;">
                <span class="stat-label">Diversification Ratio</span>
                <span class="stat-value">${(correlationMetrics.diversification_ratio || 0).toFixed(2)}</span>
              </div>
              <div class="sim-stat hinted" data-key="effective_assets" data-value="${correlationMetrics.effective_assets || 0}" style="justify-content:space-between;">
                <span class="stat-label">Effective Assets</span>
                <span class="stat-value">${Math.round(correlationMetrics.effective_assets || 0)}</span>
              </div>
            </div>
          `;

        setTimeout(() => {
          window.decorateRiskTooltips?.();
        }, 100);

      } catch (e) {
        console.warn('Risk attribution load failed:', e);
        el.innerHTML = `<div class="warning">Erreur lors du calcul d'attribution: ${e.message}</div>`;
      }
    }

    // Make functions globally available (called by switchTab in main controller)
    window.loadAdvancedRiskComponents = loadAdvancedRiskComponents;
  </script>

  <!-- Flyout Panel System -->

  <!-- Unified Risk Flyout Panel (Full Sidebar) -->
  <script type="module" src="components/flyout-panel.js"></script>
  <script type="module" src="components/risk-sidebar-full.js"></script>
  <script type="module">
    // Adapter le layout quand la sidebar est √©pingl√©e
    import { enableFlyoutLayoutAdapter } from './components/flyout-layout-adapter.js';
    enableFlyoutLayoutAdapter('.wrap'); // D√©caler uniquement le contenu, pas le menu
  </script>

  <flyout-panel position="left" width="280" persist-key="risk_dashboard_flyout">
    <span slot="title">üéØ Risk Dashboard</span>
    <risk-sidebar-full slot="content" poll-ms="0"></risk-sidebar-full>
  </flyout-panel>

</body>

</html>
