<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>üìä Dashboard - SmartFolio</title>
    <link rel="stylesheet" href="shared-theme.css">
    <link rel="stylesheet" href="theme-compat.css">
    <script type="module" src="components/nav.js"></script>
    <script type="module" src="components/tooltips.js"></script>
    <script type="module">
        import { initDeepLinks } from './components/deep-links.js';
        // Anchors for dashboard.html: #global #crypto #bourse #banque #overview #market-regime #risk-alerts
        initDeepLinks({
            'global': 'Global Overview',
            'crypto': 'Crypto',
            'bourse': 'Stock Market',
            'banque': 'Wealth',
            'overview': 'Global Insight',
            'market-regime': 'Market Regime',
            'risk-alerts': 'Risk & Alerts'
        });
    </script>

    <script src="debug-logger.js"></script>
    <script src="input-validator.js"></script>
    <script src="performance-optimizer.js"></script>
    <script src="global-config.js"></script>
    <script src="appearance.js"></script>
    <script type="module" src="modules/dashboard-main-controller.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>

    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background: var(--theme-background);
            color: var(--theme-text);
            font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;
            line-height: 1.6;
            min-height: 100vh;
        }

        .wrap {
            max-width: 95vw;
            margin: 0 auto;
            padding: 20px;
        }

        .dashboard-grid {
            display: grid;
            gap: 20px;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            margin-top: 20px;
        }

        .card {
            background: var(--theme-surface);
            border: 1px solid var(--theme-border);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            transition: all var(--transition-normal);
            box-shadow: var(--shadow-sm);
        }

        .card:hover {
            border-color: var(--brand-primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
            padding-bottom: var(--space-md);
            border-bottom: 1px solid var(--theme-border);
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .card-icon {
            font-size: 24px;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 12px 0;
            padding: 8px 0;
        }

        .metric-label {
            color: var(--theme-text-muted);
            font-size: 14px;
        }

        .metric-value {
            font-weight: 600;
            font-size: 16px;
            color: var(--theme-text);
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-active {
            background: var(--success-bg);
            color: var(--success);
            border: 1px solid var(--success);
        }

        .status-warning {
            background: var(--warning-bg);
            color: var(--warning);
            border: 1px solid var(--warning);
        }

        .status-error {
            background: var(--danger-bg);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 16px;
        }

        .action-btn {
            background: var(--brand-primary);
            color: white;
            text-decoration: none;
            padding: var(--space-md) var(--space-lg);
            border-radius: var(--radius-md);
            font-weight: 600;
            text-align: center;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
        }

        .action-btn:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
            background: var(--brand-primary-hover);
        }

        .action-btn.secondary {
            background: var(--theme-surface-elevated);
            color: var(--theme-text);
            border: 1px solid var(--theme-border);
        }

        .action-btn.secondary:hover {
            border-color: var(--brand-primary);
            color: var(--brand-primary);
            background: var(--theme-surface-hover);
        }

        /* Container for Chart.js charts */
        .portfolio-chart {
            height: 210px;
            position: relative;
            margin: var(--space-lg) 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .portfolio-chart canvas {
            max-height: 100%;
            max-width: 100%;
        }

        .recent-activity {
            max-height: 300px;
            overflow-y: auto;
        }

        .activity-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-sm) 0;
            border-bottom: 1px solid var(--theme-border);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-desc {
            color: var(--theme-text-muted);
            font-size: 13px;
        }

        .activity-time {
            color: var(--theme-text-muted);
            font-size: 12px;
        }

        .connections-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
            margin-top: 12px;
        }

        .connection-item {
            text-align: center;
            padding: var(--space-md);
            border-radius: var(--radius-md);
            border: 1px solid var(--theme-border);
            background: var(--theme-surface-elevated);
        }

        .connection-name {
            font-size: 12px;
            margin-bottom: 4px;
            color: var(--theme-text-muted);
        }

        .loading {
            color: var(--theme-text-muted);
            text-align: center;
            padding: var(--space-xl);
        }

        .error {
            color: var(--danger);
            text-align: center;
            padding: var(--space-xl);
            background: var(--danger-bg);
            border: 1px solid var(--danger);
            border-radius: var(--radius-md);
            margin: var(--space-md) 0;
        }

        /* Hierarchical Levels - Dashboard V2 */
        .level-1 {
            border-left: 4px solid var(--warning);
            background: var(--theme-surface);
            box-shadow: inset 0 0 0 1px var(--warning-bg);
        }

        .level-2 {
            border-left: 4px solid var(--info);
            background: var(--theme-surface);
            box-shadow: inset 0 0 0 1px var(--info-bg);
        }

        .level-3 {
            border-left: 4px solid var(--brand-primary);
            background: var(--theme-surface);
            box-shadow: inset 0 0 0 1px rgba(var(--brand-primary-rgb), 0.1);
        }

        /* Level Badges */
        .badge-hero {
            background: var(--warning);
            color: var(--theme-bg);
            font-weight: 700;
        }

        .badge-primary {
            background: var(--info);
            color: var(--theme-bg);
            font-weight: 700;
        }

        .badge-secondary {
            background: var(--brand-primary);
            color: white;
            font-weight: 700;
        }

        /* Market Regime Progress Bars */
        .regime-item {
            margin-bottom: 12px;
        }

        .regime-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
        }

        .regime-label {
            font-size: 0.85em;
            color: var(--theme-text-muted);
            font-weight: 600;
        }

        .regime-status {
            font-size: 0.9em;
            font-weight: 700;
        }

        .regime-status.bull {
            color: var(--success);
        }

        .regime-status.bear {
            color: var(--danger);
        }

        .regime-status.expansion {
            color: var(--info);
        }

        .regime-status.consolidation {
            color: var(--warning);
        }

        .regime-progress-bar {
            background: var(--theme-surface-elevated);
            border: 1px solid var(--theme-border);
            border-radius: 4px;
            height: 8px;
            overflow: hidden;
        }

        .regime-progress-fill {
            height: 100%;
            transition: width 0.3s ease;
        }

        .regime-progress-fill.bull {
            background: var(--success);
        }

        .regime-progress-fill.bear {
            background: var(--danger);
        }

        .regime-progress-fill.expansion {
            background: var(--info);
        }

        .regime-progress-fill.consolidation {
            background: var(--warning);
        }

        .regime-confidence {
            font-size: 0.75em;
            color: var(--theme-text-muted);
            margin-top: 2px;
        }

        /* Phase Indicators */
        .phase-indicator {
            display: flex;
            gap: 6px;
            margin: 12px 0;
            flex-wrap: wrap;
        }

        .phase-chip {
            flex: 1;
            min-width: 80px;
            padding: 6px 8px;
            border-radius: 6px;
            text-align: center;
            font-size: 0.75em;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .phase-chip.active {
            background: var(--success);
            color: white;
            box-shadow: 0 2px 4px var(--success-bg);
        }

        .phase-chip.inactive {
            background: var(--theme-surface-elevated);
            color: var(--theme-text-muted);
            border: 1px solid var(--theme-border);
        }

        /* Alert Items */
        .alert-item {
            background: var(--danger-bg);
            border-left: 3px solid var(--danger);
            padding: 10px 12px;
            border-radius: 6px;
            margin: 8px 0;
            font-size: 0.9em;
            line-height: 1.4;
            color: var(--theme-text);
        }

        .alert-item.warning {
            background: var(--warning-bg);
            border-left-color: var(--warning);
        }

        .alert-item.info {
            background: var(--info-bg);
            border-left-color: var(--info);
        }

        .alert-item.success {
            background: var(--success-bg);
            border-left-color: var(--success);
        }

        .alert-item.critical {
            background: var(--danger-bg);
            border-left-color: var(--danger);
        }

        /* Empty states */
        .empty-state {
            display: none;
            text-align: center;
            color: var(--theme-text-muted);
            font-size: 0.85rem;
            margin-top: 12px;
        }

        .empty-state a {
            color: var(--theme-accent);
            text-decoration: underline;
        }

        /* Loading spinner */
        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid var(--theme-border);
            border-top-color: var(--brand-primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            display: inline-block;
            margin-right: 8px;
            vertical-align: middle;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Accessibility - screen reader only */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .quick-actions {
                grid-template-columns: 1fr;
            }

            .phase-chip {
                min-width: 70px;
                font-size: 0.7em;
                padding: 4px 6px;
            }

            /* Force single column for span 2 cards */
            #overview {
                grid-column: span 1 !important;
            }
        }
    </style>


</head>

<body>
    <main class="wrap" role="main">
        <!-- LEVEL 1: WEALTH -->
        <div class="dashboard-grid" id="grid-niveau-1">
            <!-- Global Overview ENHANCED -->
            <div class="card level-1" id="global" draggable="true"
                data-tooltip="Global overview of your wealth (Crypto + Stock Market + Banks) with total P&L Today"
                data-source="API /api/wealth/global/summary">
                <div class="card-header">
                    <div class="card-title"><span class="card-icon">üåê</span>Global Overview</div>
                </div>

                <!-- Total Global + P&L Today header -->
                <div style="text-align:center;padding:12px 0;border-bottom:1px solid var(--theme-border);">
                    <div style="font-size:0.85rem;color:var(--theme-text-muted);margin-bottom:4px;">Total Wealth
                    </div>
                    <div id="global-total-value" style="font-size:2rem;font-weight:900;color:var(--theme-text);">--
                    </div>
                    <div id="global-pnl-today" style="font-size:0.95rem;font-weight:600;margin-top:4px;">--</div>

                    <!-- Values in EUR and CHF -->
                    <div id="global-currency-conversions"
                        style="margin-top:8px;font-size:0.75rem;color:var(--theme-text-muted);">
                        <div id="global-total-eur">-- EUR</div>
                        <div id="global-total-chf">-- CHF</div>
                    </div>
                </div>

                <!-- Modules with integrated charts -->
                <div id="global-breakdown" style="display:flex;flex-direction:column;gap:8px;margin-top:12px;">
                    <!-- Module cards will be added here by JS -->
                </div>
            </div>

            <!-- Crypto Overview -->
            <div class="card level-1" id="crypto" draggable="true"
                data-tooltip="Overview of your crypto portfolio with performance metrics"
                data-source="API /balances/current + prices CoinGecko/CoinGlass">
                <div class="card-header">
                    <div class="card-title"><span class="card-icon">‚Çø</span>Crypto</div>
                    <div style="display:flex;gap:8px;align-items:center;">
                        <span id="portfolio-source-display"
                            style="font-size:11px;color:var(--theme-text-muted);padding:2px 6px;background:var(--theme-bg);border-radius:4px;border:1px solid var(--theme-border);">--</span>
                        <span class="status-badge status-active" id="portfolio-status" role="status" aria-live="polite">Loading</span>
                    </div>
                </div>

                <div class="metric">
                    <span class="metric-label">Total Value</span>
                    <span class="metric-value" id="total-value">--</span>
                </div>

                <div class="metric">
                    <span class="metric-label">P&L Today</span>
                    <span class="metric-value" id="daily-pnl">--</span>
                </div>

                <div class="metric">
                    <span class="metric-label">Assets Count</span>
                    <span class="metric-value" id="assets-count">--</span>
                </div>

                <div class="portfolio-chart" id="portfolio-chart" style="height: 140px; margin-top: 12px;">
                    <canvas id="portfolioChartCanvas" width="400" height="200" aria-label="Crypto portfolio distribution chart"></canvas>
                </div>

                <!-- Export Button -->
                <button id="crypto-export-btn" class="action-btn secondary" style="margin-top: 12px; width: 100%;" aria-label="Export crypto portfolio lists">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    Export Lists
                </button>

                <div id="crypto-empty-state" class="empty-state">
                    No crypto data.<br>
                    <a href="settings.html#sources">Configure a source in Settings</a>
                </div>
            </div>

            <!-- Stock Market (Saxo) Overview -->
            <div class="card level-1" id="bourse" draggable="true"
                data-tooltip="Overview of your stocks and ETF portfolio via Saxo Bank in read-only mode."
                data-source="API /api/saxo/positions (legacy)">
                <div class="card-header">
                    <a href="saxo-dashboard.html" class="card-title" style="text-decoration: none; color: inherit;" aria-label="Navigate to Stock Market dashboard">
                        <span class="card-icon">üè¶</span>Stock Market
                    </a>
                </div>

                <div class="metric">
                    <span class="metric-label">Total Value</span>
                    <span class="metric-value" id="saxo-total-value">--</span>
                </div>

                <div class="metric">
                    <span class="metric-label">Positions</span>
                    <span class="metric-value" id="saxo-positions-count">--</span>
                </div>

                <div class="metric">
                    <span class="metric-label">Last Import</span>
                    <span class="metric-value" id="saxo-last-import" style="font-size:0.9rem;">--</span>
                </div>

                <div class="portfolio-chart" id="saxo-chart" style="height: 140px; margin-top: 12px;">
                    <canvas id="saxoChartCanvas" width="400" height="200" aria-label="Stock market portfolio distribution chart"></canvas>
                </div>

                <!-- Export Button -->
                <button id="saxo-export-btn" class="action-btn secondary" style="margin-top: 12px; width: 100%;" aria-label="Export stock market portfolio lists">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    Export Lists
                </button>

                <div id="saxo-empty-state" class="empty-state">
                    No Saxo positions.<br>
                    <a href="settings.html#sources">Import a file in Settings</a>
                </div>
            </div>

            <!-- Wealth Overview -->
            <div class="card level-1" id="banque" draggable="true"
                data-tooltip="Overview of your wealth: cash, real estate, liabilities and insurance."
                data-source="API /api/wealth/patrimoine/summary">
                <div class="card-header">
                    <a href="wealth-dashboard.html" class="card-title" style="text-decoration: none; color: inherit;" aria-label="Navigate to Wealth dashboard">
                        <span class="card-icon">üíº</span>Wealth
                    </a>
                </div>

                <div class="metric">
                    <span class="metric-label">Net Worth</span>
                    <span class="metric-value" id="patrimoine-net-worth">--</span>
                </div>

                <div class="metric">
                    <span class="metric-label">Assets / Liabilities</span>
                    <span class="metric-value" id="patrimoine-assets-liabilities" style="font-size: 0.85rem;">--</span>
                </div>

                <div class="metric">
                    <span class="metric-label">Items</span>
                    <span class="metric-value" id="patrimoine-items-count">--</span>
                </div>

                <div class="portfolio-chart" id="patrimoine-chart" style="height: 140px; margin-top: 12px;">
                    <canvas id="patrimoineChartCanvas" width="400" height="200" aria-label="Wealth portfolio distribution chart"></canvas>
                </div>

                <!-- Export Button -->
                <button id="patrimoine-export-btn" class="action-btn secondary" style="margin-top: 12px; width: 100%;" aria-label="Export wealth portfolio lists">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    Export Lists
                </button>

                <div id="patrimoine-empty-state" class="empty-state">
                    No wealth assets.<br>
                    <a href="wealth-dashboard.html">Add one now</a>
                </div>
            </div>
        </div>

        <!-- LEVEL 2: DECISION -->
        <div class="dashboard-grid" id="grid-niveau-2" style="margin-top: 20px;">
            <!-- Global Insight -->
            <div class="card level-2" id="overview" draggable="true" style="grid-column: span 2;"
                data-tooltip="Unified view: decision, cycle, on-chain, risk + intelligent Phase Engine"
                data-source="Unified scores from Risk Dashboard + Phase Engine">
                <div class="card-header">
                    <a href="analytics-unified.html" class="card-title" style="text-decoration: none; color: inherit;">
                        <span class="card-icon">üß≠</span> Global Insight
                    </a>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                    <div>
                        <div style="font-size: 0.85rem; color: var(--theme-text-muted); font-weight: 600;">Decision
                            Index</div>
                        <div id="gi-score" style="font-size: 2.5rem; font-weight: 900;">--</div>
                        <div class="phase-indicator">
                            <div class="phase-chip inactive" id="phase-risk-off">Risk Off</div>
                            <div class="phase-chip inactive" id="phase-eth-exp">ETH Expansion</div>
                            <div class="phase-chip inactive" id="phase-altseason">Altseason</div>
                        </div>
                    </div>
                    <div>
                        <div class="metric">
                            <span class="metric-label">üîÑ Cycle Score</span>
                            <span class="metric-value" id="gi-cycle">--</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">‚õìÔ∏è On-Chain Score</span>
                            <span class="metric-value" id="gi-onchain">--</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">üõ°Ô∏è Risk Score</span>
                            <span class="metric-value" id="gi-risk">--</span>
                        </div>
                    </div>
                </div>
                <div id="gi-reco"
                    style="margin-top: 12px; padding: 10px; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 0.9em;">
                </div>
                <div id="gi-meta"
                    style="text-align: center; font-size: 11px; color: var(--theme-text-muted); margin-top: 8px; padding-top: 8px; border-top: 1px solid var(--theme-border);">
                </div>
            </div>

            <!-- Market Regime -->
            <div class="card level-2" id="market-regime" draggable="true"
                data-tooltip="Intelligent detection of market regimes for BTC, ETH and stocks"
                data-source="ML Regime Detection API">
                <div class="card-header">
                    <a href="ai-dashboard.html#regimes" class="card-title"
                        style="text-decoration: none; color: inherit;">
                        <span class="card-icon">üìà</span> Market Regime
                    </a>
                </div>
                <div id="regime-content">
                    <div class="regime-item">
                        <div class="regime-header">
                            <span class="regime-label">Bitcoin</span>
                            <span class="regime-status bull" id="regime-btc-status">--</span>
                        </div>
                        <div class="regime-progress-bar">
                            <div class="regime-progress-fill bull" id="regime-btc-bar" style="width: 0%;"></div>
                        </div>
                        <div class="regime-confidence" id="regime-btc-conf">--</div>
                    </div>

                    <div class="regime-item">
                        <div class="regime-header">
                            <span class="regime-label">Ethereum</span>
                            <span class="regime-status expansion" id="regime-eth-status">--</span>
                        </div>
                        <div class="regime-progress-bar">
                            <div class="regime-progress-fill expansion" id="regime-eth-bar" style="width: 0%;"></div>
                        </div>
                        <div class="regime-confidence" id="regime-eth-conf">--</div>
                    </div>

                    <div class="regime-item" style="margin-bottom: 0;">
                        <div class="regime-header">
                            <span class="regime-label">Stock Market</span>
                            <span class="regime-status consolidation" id="regime-stock-status">--</span>
                        </div>
                        <div class="regime-progress-bar">
                            <div class="regime-progress-fill consolidation" id="regime-stock-bar" style="width: 0%;">
                            </div>
                        </div>
                        <div class="regime-confidence" id="regime-stock-conf">--</div>
                    </div>
                </div>
            </div>

            <!-- Risk & Alerts -->
            <div class="card level-2" id="risk-alerts" draggable="true"
                data-tooltip="Active risk alerts, portfolio risk level and VaR"
                data-source="Risk Dashboard + Governance Alerts">
                <div class="card-header">
                    <a href="risk-dashboard.html" class="card-title" style="text-decoration: none; color: inherit;">
                        <span class="card-icon">üö®</span> Risk & Alerts
                    </a>
                </div>
                <div class="metric">
                    <span class="metric-label">Risk Level</span>
                    <span class="metric-value" id="risk-level" style="color: var(--warning);">--</span>
                </div>
                <div id="alerts-container" style="max-height: 180px; overflow-y: auto;">
                    <div class="loading" style="padding: 12px; text-align: center;">
                        <div class="spinner" aria-hidden="true"></div>
                        Loading alerts...
                    </div>
                </div>
                <div
                    style="margin-top: 8px; padding-top: 8px; border-top: 1px solid var(--theme-border); font-size: 0.85em; color: var(--theme-text-muted);">
                    <strong>Active Alerts:</strong> <span id="alerts-count">--</span><br>
                    <strong>Portfolio VaR (95%):</strong> <span id="portfolio-var">--</span>
                </div>
            </div>
        </div>

        <!-- LEVEL 3: OPERATIONS & SYSTEM -->
        <div class="dashboard-grid" id="grid-niveau-3" style="margin-top: 20px;">
            <!-- Execution Status -->
            <div class="card level-3" id="card-execution" draggable="true"
                data-tooltip="Status of automatic trade executions with performance history and processed volumes."
                data-source="API /execution/status + internal logs">
                <div class="card-header">
                    <div class="card-title"><span class="card-icon">üéØ</span>Execution</div>
                </div>
                <div class="metric">
                    <span class="metric-label">Last Execution</span>
                    <span class="metric-value" id="last-execution">--</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Success Rate (24h)</span>
                    <span class="metric-value" id="success-rate">--</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Total Volume (24h)</span>
                    <span class="metric-value" id="volume-24h">--</span>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="card level-3" id="card-activity" draggable="true"
                data-tooltip="History of recent trading operations, rebalancing and system events."
                data-source="API /execution/history + system logs">
                <div class="card-header">
                    <div class="card-title"><span class="card-icon">üìã</span>Activity</div>
                </div>
                <div class="recent-activity" id="recent-activity">
                    <div class="loading">
                        <div class="spinner" aria-hidden="true"></div>
                        Loading recent activity...
                    </div>
                </div>
            </div>

            <!-- System Status MERGED (Exchange + Health) -->
            <div class="card level-3" id="card-system" draggable="true"
                data-tooltip="System status: exchange connections, APIs, data freshness and security."
                data-source="Internal monitoring + API tests + connectivity">
                <div class="card-header">
                    <div class="card-title"><span class="card-icon">‚ö°</span>System Status</div>
                </div>
                <div class="metric">
                    <span class="metric-label">API Status</span>
                    <span class="metric-value" id="api-status">--</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Exchanges</span>
                    <span class="metric-value" id="exchanges-status">--</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Data Freshness</span>
                    <span class="metric-value" id="data-freshness">--</span>
                </div>
            </div>

            <!-- Tools & Analytics -->
            <div class="card level-3" id="card-tools" draggable="true"
                data-tooltip="Quick access to advanced tools: Analytics, AI Dashboard, Optimization and Performance."
                data-source="Internal links and advanced tools">
                <div class="card-header">
                    <div class="card-title"><span class="card-icon">üîß</span>Tools & Analytics</div>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 6px;">
                    <a href="analytics-unified.html"
                        style="color: var(--theme-text); background: var(--theme-surface-elevated); text-decoration: none; padding: 10px 8px; border: 1px solid var(--theme-border); border-radius: 6px; text-align: center; font-size: 0.85em; transition: all 0.2s;">
                        üìä Analytics
                    </a>
                    <a href="ai-dashboard.html"
                        style="color: var(--theme-text); background: var(--theme-surface-elevated); text-decoration: none; padding: 10px 8px; border: 1px solid var(--theme-border); border-radius: 6px; text-align: center; font-size: 0.85em; transition: all 0.2s;">
                        ü§ñ AI Dashboard
                    </a>
                    <a href="portfolio-optimization.html"
                        style="color: var(--theme-text); background: var(--theme-surface-elevated); text-decoration: none; padding: 10px 8px; border: 1px solid var(--theme-border); border-radius: 6px; text-align: center; font-size: 0.85em; transition: all 0.2s;">
                        üéØ Optimization
                    </a>
                    <a href="debug-menu.html"
                        style="color: var(--theme-text); background: var(--theme-surface-elevated); text-decoration: none; padding: 10px 8px; border: 1px solid var(--theme-border); border-radius: 6px; text-align: center; font-size: 0.85em; transition: all 0.2s;">
                        üõ†Ô∏è Debug
                    </a>
                </div>
            </div>

        </div>
    </main>

</body>

</html>