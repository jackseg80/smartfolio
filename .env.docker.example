# Docker Production Configuration for SmartFolio
# Copy this file to .env before running docker-compose
# Target: Ubuntu 24.04.2 LTS on NUC with Docker

# ==============================================================================
# DOCKER-SPECIFIC SETTINGS (DO NOT CHANGE)
# ==============================================================================

# Host must be 0.0.0.0 for container networking
HOST=0.0.0.0

# Port for LAN access (change if needed, then update docker-compose.prod.yml)
PORT=8080

# API Base URL (for internal HTTP calls between services)
# In Docker, use localhost since backend calls itself within same container
# IMPORTANT: Must match PORT above
API_BASE_URL=http://localhost:8080

# Redis connection - use Docker service name as hostname
REDIS_URL=redis://redis:6379/0

# ==============================================================================
# ENVIRONMENT SETTINGS
# ==============================================================================

DEBUG=false
ENVIRONMENT=production
RISK_SCORE_V2_ENABLED=true

# Enable scheduler for auto P&L snapshots, OHLCV updates, monitoring
# Set to 0 to disable background tasks (dev/testing only)
RUN_SCHEDULER=1

# Enable Playwright-based crypto scraping (required for crypto-toolbox)
CRYPTO_TOOLBOX_NEW=1

# ==============================================================================
# SECURITY NOTICE - API Keys & Secrets
# ==============================================================================
#
# ⚠️  API keys are NO LONGER stored in .env (not multi-tenant safe)
#
# Store API keys in: data/users/{user_id}/secrets.json
#
# Template for secrets.json:
# {
#   "dev_mode": {"enabled": false, "mock_data": false},
#   "coingecko": {"api_key": "YOUR_COINGECKO_KEY", "pro": false},
#   "cointracking": {"api_key": "", "api_secret": ""},
#   "binance": {"api_key": "", "api_secret": "", "testnet": true},
#   "kraken": {"api_key": "", "api_secret": ""},
#   "exchanges": {"default": "binance"}
# }
#
# Transfer secrets.json from Windows to NUC:
# scp data/users/demo/secrets.json user@nuc-ip:/opt/smartfolio/data/users/demo/
# scp data/users/jack/secrets.json user@nuc-ip:/opt/smartfolio/data/users/jack/
#
# ==============================================================================

# Debug token (optional, for development only)
# Generate with: openssl rand -hex 32
DEBUG_TOKEN=

# Admin key (optional, for admin endpoints)
# Generate with: openssl rand -hex 32
ADMIN_KEY=

# ==============================================================================
# DATA SOURCE SETTINGS
# ==============================================================================

# Allow stub/mock data sources (dev/testing only)
ALLOW_STUB_SOURCES=false
COMPUTE_ON_STUB_SOURCES=false

# ==============================================================================
# RATE LIMITING
# ==============================================================================

RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60

# ==============================================================================
# LOGGING
# ==============================================================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# ==============================================================================
# DEBUG & TESTING FEATURES (DEV ONLY - NEVER enable in production)
# ==============================================================================

DEBUG_SIMULATION=false
ENABLE_ALERTS_TEST_ENDPOINTS=false

# ==============================================================================
# CORS SETTINGS (development only)
# ==============================================================================

# Leave empty for production (no CORS)
# For dev with separate frontend: http://localhost:3000,http://localhost:8000
CORS_ORIGINS=

# ==============================================================================
# MIGRATION CHECKLIST
# ==============================================================================
#
# Before starting Docker stack:
#
# 1. Copy this file: cp .env.docker .env
# 2. Transfer user data: scp -r data/users/* user@nuc-ip:/opt/smartfolio/data/users/
# 3. Transfer secrets: scp data/users/*/secrets.json user@nuc-ip:/opt/smartfolio/data/users/
# 4. Build image: docker-compose -f docker-compose.prod.yml build
# 5. Start stack: docker-compose -f docker-compose.prod.yml up -d
# 6. Check logs: docker-compose -f docker-compose.prod.yml logs -f
# 7. Test API: curl http://localhost:8080/docs
# 8. Test LAN: http://<nuc-ip>:8080/ from Windows browser
#
# ==============================================================================
